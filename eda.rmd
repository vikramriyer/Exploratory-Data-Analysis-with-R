```{r}
# use wineQualityReds.csv for the dataset
# use the Redirecting.txt to read about the dataset
```

# Familiarize with data
```{r}
# Load data
wine = read.csv('/data/myhome/vikram-code-school/ND/P4/datasets/wineQualityReds.csv')
names(wine)
```

# summary of the data
```{r}
summary(wine)
```

# chunk of data
```{r}
head(wine)
```

# Total observations and fields
```{r}
dim(wine)
```

# structure of the dataset
```{r}
str(wine)
```

```{r}
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(gridExtra))
```

#Univariate Analysis

##By looking at the values of the quality we can say that it has a range that is absolute. Hence, we can convert into factor and check if we cab obtains levels

```{r}
wine$quality.asFactor <- factor(wine$quality)

levels(wine$quality.asFactor)
```

##Let's plot all the variables and view them from under the hood of univariate
```{r}


p1 <- ggplot(aes(x = quality.asFactor), data = wine) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey')

p2 <- ggplot(aes(x = citric.acid), data = wine) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey')

p3 <- ggplot(aes(x = alcohol), data = wine) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey')

p4 <- ggplot(aes(x = sulphates), data = wine) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey')

p5 <- ggplot(aes(x = fixed.acidity), data = wine) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey')

p6 <- ggplot(aes(x = density), data = wine) +
  geom_histogram(color = 'black', fill = 'grey')

p7 <- ggplot(aes(x = pH), data = wine) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey')

p8 <- ggplot(aes(x = total.sulfur.dioxide), data = wine) +
  scale_x_continuous(limits = c(0,170), breaks = seq(0,170,5)) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey')

p9 <- ggplot(aes(x = volatile.acidity), data = wine) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey')

p10 <- ggplot(aes(x = free.sulfur.dioxide), data = wine) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey')

p11 <- ggplot(aes(x = chlorides), data = wine) +
  scale_x_continuous(limits = c(0,0.2), breaks = seq(0,0.2,0.01)) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey')

p12 <- ggplot(aes(x = residual.sugar), data = wine) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey')
```

```{r}
grid.arrange(p1, p2, p3, p4, ncol = 2)
## w.r.t the plots below we can conclude that, 
# quality, suphates => have normal or close to normal distribution
# citric.acid => does not
```

```{r}
grid.arrange(p5, p6, p7, p8, ncol = 2)
# density, fixed.acidity, pH => have normal distributions
```


```{r}
grid.arrange(p9, p10, p11, p12, ncol = 2)
```
## Variables having normal and not having normal distributions
```{r}
####################################################
#        Normal         |       Not Normal         #
####################################################
# 1. alcohol            | citric.acid              #
# 2. fixed.acidity      | residual.sugar           #
# 3. volatile.acidity   | chlorides                #
# 4. density            | free.sulphur.dioxide     #
# 5. pH                 | total.sulphur.dioxide    #
# 6. quality            | sulphates                #
####################################################
```

### So, we need to transform the variables which do not look normal or close to. We can use the log10
```{r}
t1 <- ggplot(aes(x = sulphates), data = wine) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey') +
  scale_x_log10()

t2 <- ggplot(aes(x = total.sulfur.dioxide), data = wine) +
  scale_x_continuous(limits = c(0,170), breaks = seq(0,170,5)) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey') +
  scale_x_log10()

t3 <- ggplot(aes(x = free.sulfur.dioxide), data = wine) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey') +
  scale_x_log10()

t4 <- ggplot(aes(x = chlorides), data = wine) +
  scale_x_continuous(limits = c(0,0.2), breaks = seq(0,0.2,0.01)) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey') +
  scale_x_log10()

t5 <- ggplot(aes(x = residual.sugar), data = wine) +
  geom_histogram(stat = 'count', color = 'black', fill = 'grey') +
  scale_x_log10()

grid.arrange(t1, t2, t3, t4, t5, ncol = 2)
```


### let's define levels for quality of wine
```{r}
levels(wine$quality.asFactor)
```

```{r}
# let's further classify them into 3 ordinal variables: low(3,4), medium(5,6), high(7,8)
low <- wine$quality <= 4
medium <- wine$quality > 4 & wine$quality < 7
high <- wine$quality > 6
wine$quality.category <- factor(ifelse(low, 'low', ifelse(medium, 'medium', 'high')), levels = c("low", "medium", "high"))
levels(wine$quality.category)
```

## BiVariate Analysis: Comparing each of the attributes/compounds of wine with quality and coming to conclusions
# Let's start by plotting a simple graph
```{r}
names(wine)
ggplot(aes(x = quality.category, y = alcohol), data = wine) +
  geom_boxplot(fill="green")
## higher the content of alcohol, better the quality
```
### Let's draw plots for all variables against quality of red wine and analyze which variable has a relation(positive, negative, no relation) with quality of red wine
```{r}
names(wine)
b1 <- ggplot(aes(x = quality.category, y = alcohol), data = wine) +
  geom_boxplot(fill="green")
b2 <- ggplot(aes(x = quality.category, y = citric.acid), data = wine) +
  geom_boxplot(fill="green")
b3 <- ggplot(aes(x = quality.category, y = sulphates), data = wine) +
  geom_boxplot(fill="green")
b4 <- ggplot(aes(x = quality.category, y = fixed.acidity), data = wine) +
  geom_boxplot(fill="green")
grid.arrange(b1, b2, b3, b4, ncol = 2)
```

#### Conclusion: The above factors depict that, they are directly proportional to quality of red wine, i.e. higher the factor, better the quality

###Let's check the remaining ones
```{r}
b5 <- ggplot(aes(x = quality.category, y = pH), data = wine) +
  geom_boxplot(fill="red")
b6 <- ggplot(aes(x = quality.category, y = density), data = wine) +
  geom_boxplot(fill="red")
b7 <- ggplot(aes(x = quality.category, y = volatile.acidity), data = wine) +
  geom_boxplot(fill="red")
grid.arrange(b5, b6, b7, ncol = 2)
```

#### Conclusion: The above factors denote that, they are inversely proportional to quality of red wine, i.e. lower the factor, better the quality

### Let's try to find a overview of all the variables using the ggpairs function
```{r}
suppressPackageStartupMessages(library(GGally))
names(wine)
ggpairs(wine, columns = 2:13, title = 'bivariate red wine analysis')
```


```{r}
## timepass
ggplot(aes(x=alcohol,y=density),data=wine)+
  geom_point(aes(color=wine$quality.category, alpha=1/10))+
  geom_vline(aes(xintercept = 11),linetype="longdash")+geom_smooth(method = "lm")+
  xlab("alcohol %")
names(wine)
```


```{r}
ggplot(aes(x = quality, y = pH), data = wine) +
  geom_point() +
  stat_smooth(method = 'lm', se = FALSE)
## This is a negative
summary(wine$quality)
```


### The first thing we notice is that, all the values are in the range 0-7, which means acidic
### Now, as I could clearly see an outlier here, quality = 6, pH > 4; I became curious as to is there a standard pH value for wine.
### And it turns out that, generally, wine has pH range between 2.9 to 3.9. Let's verify if this is true in our dataset

```{r}
length(wine$X)
length(wine$pH[wine$pH > 2.9 & wine$pH < 3.9])
```

### Whoa! Out of the total 1599 observations, 1585 are in the range that we expected them to be in. You can refer to 'ref link 1' below. Let's see which are the outliers or the ones
### that do not follow the convention
```{r}
wine$pH[wine$pH < 2.9 | wine$pH > 3.9]
```

### 

```{r}
names(wine)
```
```{r}
ggplot(aes(x = pH), data = wine) +
  geom_histogram() +
  scale_x_continuous(limits = c(2.7, 4.1), breaks = seq(2.7,4.1,0.1))
```

```{r}
ggplot(aes(x = pH, color = I('black'), fill = I('#408463')), data = wine) +
  geom_histogram() +
  scale_x_continuous(limits = c(3.2, 3.4), breaks = seq(3.2,3.4,0.01))
```

```{r}
names(wine)
```



















# References:
#### ref link 1: https://en.wikipedia.org/wiki/Acids_in_wine
#### ref link 2:
#### ref link 3:
#### ref link 